{"ast":null,"code":"var _a, _b, _c;\nimport { __decorate, __metadata } from \"tslib\";\nimport { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { GurantorResponse } from '../../../setups/guarantors/classes/responseMedel';\nimport { APIService } from '../../../components/services/api.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { DatePipe } from '@angular/common';\nimport { Common } from '../../../services/common/common';\nimport { BaseComponent } from '../../../core/base/base.component';\nimport { ToastrService } from 'ngx-toastr';\nexport class ZipData {\n  constructor() {\n    this.CityName = '';\n    this.State = '';\n  }\n}\nlet AddEditGuarantorSharedComponent = class AddEditGuarantorSharedComponent extends BaseComponent {\n  constructor(API, router, route, datepipe, toaster) {\n    super();\n    this.API = API;\n    this.router = router;\n    this.route = route;\n    this.datepipe = datepipe;\n    this.toaster = toaster;\n    this.mode = \"page\";\n    this.onCancelEvent = new EventEmitter();\n    this.today = new Date();\n    this.myDatePickerOptions = {\n      dateFormat: 'mm/dd/yyyy',\n      height: '25px',\n      width: '100%',\n      disableSince: {\n        year: this.today.getFullYear(),\n        month: this.today.getMonth() + 1,\n        day: this.today.getDate() + 1\n      }\n    };\n    this.title = \"\";\n    this.onAddGuarantor = new EventEmitter();\n    this.GurantorModel = new GurantorResponse();\n    this.ZipGruntordata = [];\n  }\n  ngOnInit() {\n    if (this.caller === 'PATIENT_FINANCIAL_GUARANTOR') return;\n    this.route.params.subscribe(params => {\n      let id = +params['id'];\n      if (id) {\n        this.title = \"Edit Guarantor\";\n        this.getGuarantor(id);\n      } else this.title = \"Add Guarantor\";\n    });\n  }\n  getGuarantor(id) {\n    debugger;\n    this.API.getData(`/Setup/GetGurantor?GurantorId=${id}`).subscribe(data => {\n      if (data.Status == \"Sucess\") {\n        debugger;\n        this.GurantorModel = data;\n        if (data.Guarant_Zip != null || data.Guarant_Zip != \"\") {\n          this.onBlurMethod(data.Guarant_Zip);\n        }\n        this.GurantorModel.Response.Guarant_Dob = this.datepipe.transform(this.GurantorModel.Response.Guarant_Dob, 'MM/dd/yyyy');\n      } else {\n        swal('Error', \"An error occurred while getting the Guarantor\");\n      }\n    });\n  }\n  AddGurantor() {\n    this.GurantorModel.Status = \"Success\";\n    this.API.PostData('/Setup/SaveGurantor/', this.GurantorModel.Response, d => {\n      if (d.Status == \"Sucess\") {\n        if (this.caller == 'PATIENT_FINANCIAL_GUARANTOR') {\n          this.handleSaveClick(d.Response);\n          return;\n        }\n        swal('Success', `Guarantor has been ${this.title === \"Edit Guarantor\" ? 'updated' : 'added'} successfully`, 'success');\n        this.router.navigate(['/guarantors']);\n      } else {\n        swal('Failure', `An error occurred while ${this.title === \"Edit Guarantor\" ? 'updating' : 'adding'} Guarantor.`, 'error');\n      }\n    });\n  }\n  onBlurMethod(param) {\n    var id = this.GurantorModel.Response.Guarant_Zip;\n    if (id == undefined || id == null || id == \"\" || id.length < 4) return;\n    this.API.getData('/Demographic/GetCitiesByZipCode?ZipCode=' + id).subscribe(data => {\n      if (data.Status == \"Sucess\") {\n        debugger;\n        if (data.Response.length == 0) {\n          this.toaster.error('Invalid Zip Code', `${id}`);\n          //add by Hamza Akhlaq \n          this.GurantorModel.Response.Guarant_Zip = '';\n          return;\n        }\n        this.ZipGruntordata = data.Response;\n        this.GurantorModel.Response.Guarant_City = this.ZipGruntordata[0].CityName;\n        this.GurantorModel.Response.Guarant_State = this.ZipGruntordata[0].State;\n      } else {\n        this.GurantorModel.Response.Guarant_City = \"\";\n        this.GurantorModel.Response.Guarant_State = \"\";\n      }\n    });\n  }\n  dateMaskGS(event) {\n    var v = event.target.value;\n    if (v) {\n      if (v.match(/^\\d{2}$/) !== null) {\n        event.target.value = v + '/';\n      } else if (v.match(/^\\d{2}\\/\\d{2}$/) !== null) {\n        event.target.value = v + '/';\n      }\n    }\n  }\n  isnullorEmpty(str) {\n    if (str == undefined || str == null) return true;\n    if ($.trim(str) == \"\") return true;else return false;\n  }\n  onDateChangedDOBAddUpdate(event) {\n    this.GurantorModel.Response.Guarant_Dob = event.formatted;\n  }\n  canSave() {\n    if (Common.isNullOrEmpty(this.GurantorModel.Response.Guarant_Lname)) {\n      return swal('Validation Error', 'Last name is Required.', 'error');\n    }\n    if (Common.isNullOrEmpty(this.GurantorModel.Response.Guarant_Fname)) {\n      return swal('Validation Error', 'First name is Required.', 'error');\n    }\n    if (Common.isNullOrEmpty(this.GurantorModel.Response.Guarant_Gender)) {\n      return swal('Validation Error', 'Gender is Required.', 'error');\n    }\n    if (Common.isNullOrEmpty(this.GurantorModel.Response.Guarant_Address)) {\n      return swal('Validation Error', 'Address is Required.', 'error');\n    }\n    if (Common.isNullOrEmpty(this.GurantorModel.Response.Guarant_City) || this.GurantorModel.Response.Guarant_City == null || this.GurantorModel.Response.Guarant_City == \"Select City\") {\n      return swal('Validation Error', 'City is Required.', 'error');\n    } else {\n      this.AddGurantor();\n    }\n  }\n  onCancel() {\n    if (this.mode == \"page\") this.router.navigate([`/guarantors`]);else if (this.mode == \"modal\") {\n      this.onCancelEvent.emit();\n    }\n  }\n  handleSaveClick({\n    Guarantor_Code,\n    Guarant_Fname,\n    Guarant_Lname\n  }) {\n    if (this.caller === 'PATIENT_FINANCIAL_GUARANTOR') {\n      this.onAddGuarantor.emit({\n        for: 'PATIENT_FINANCIAL_GUARANTOR',\n        data: {\n          guarantorName: Guarant_Lname + ' , ' + Guarant_Fname,\n          guarantorCode: Guarantor_Code\n        }\n      });\n    }\n  }\n  resetForm() {\n    this.GurantorModel = new GurantorResponse();\n  }\n};\n__decorate([Input(), __metadata(\"design:type\", String)], AddEditGuarantorSharedComponent.prototype, \"caller\", void 0);\n__decorate([Input(), __metadata(\"design:type\", String)], AddEditGuarantorSharedComponent.prototype, \"mode\", void 0);\n__decorate([Output(), __metadata(\"design:type\", Object)], AddEditGuarantorSharedComponent.prototype, \"onCancelEvent\", void 0);\n__decorate([Output(), __metadata(\"design:type\", EventEmitter)], AddEditGuarantorSharedComponent.prototype, \"onAddGuarantor\", void 0);\nAddEditGuarantorSharedComponent = __decorate([Component({\n  selector: 'app-add-edit-guarantor-shared',\n  templateUrl: './add-edit-guarantor-shared.component.html',\n  styleUrls: ['./add-edit-guarantor-shared.component.css']\n}), __metadata(\"design:paramtypes\", [APIService, typeof (_a = typeof Router !== \"undefined\" && Router) === \"function\" ? _a : Object, typeof (_b = typeof ActivatedRoute !== \"undefined\" && ActivatedRoute) === \"function\" ? _b : Object, DatePipe, typeof (_c = typeof ToastrService !== \"undefined\" && ToastrService) === \"function\" ? _c : Object])], AddEditGuarantorSharedComponent);\nexport { AddEditGuarantorSharedComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}